@{
    ViewBag.Title = "课程管理";
    Layout = null;
}

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="~/layui/css/layui.css" rel="stylesheet" />
    <script src="~/layui/layui.js"></script>
    <link href="~/Content/other.css" rel="stylesheet" />
</head>
<body>
    <div class="layui-card">
        <div class="layui-card-header">@ViewBag.Title</div>
        <div class="layui-card-body">
            <table class="layui-hide" id="course-list" lay-filter="course-list"></table>

            <script type="text/html" id="course-toolbar">
                <div class="layui-btn-container">
                    <button class="layui-btn layui-btn-sm" lay-event="create">新建</button>
                </div>
            </script>

            <script type="text/html" id="course-bar">
                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">禁用</a>
            </script>

            <script type="text/html" id="isUseTpl">
                {{#  if(d.IsUse){ }}
                已启用
                {{#  } else { }}
                未启用
                {{#  } }}
            </script>

            <script>
                layui.use('table', function () {
                    var table = layui.table;
                    table.render({
                        elem: '#course-list'
                        , url: '/admin/courselistjson'
                        , toolbar: '#course-toolbar'
                        , title: '课程数据表'
                        , cols: [[
                            { field: 'IsUse', title: '状态', width: 80, templet:'#isUseTpl'}
                            , { field: 'Name', title: '名称', sort: true }
                            //, { field: 'Price', title: '单价' }
                            //, { field: 'Amount', title: '课时', width:60 }
                            , { field: 'Total', title: '总价', }
                            //, { field: 'Unit', title: '单位' }
                            , { field: 'StartDate', title: '开课日期', width: 110 , sort: true, templet: '<div>{{layui.util.toDateString(parseInt(d.StartDate.replace("/Date(","").replace(")/", ""), 10),"yyyy-MM-dd")}}</div>' }
                            , { field: 'EndDate', title: '结课日期', width: 110, sort: true, templet: '<div>{{layui.util.toDateString(parseInt(d.EndDate.replace("/Date(","").replace(")/",""), 10),"yyyy-MM-dd")}}</div>'}
                            , { field: 'CrTime', title: '创建日期', width: 110,sort: true, templet: '<div>{{layui.util.toDateString(parseInt(d.CrTime.replace("/Date(","").replace(")/",""), 10),"yyyy-MM-dd")}}</div>' }
                            , { field: 'CrUser', title: '创建人', sort: true }
                            , { field: 'UpTime', title: '更新日期', width: 110, sort: true, templet: '<div>{{layui.util.toDateString(parseInt(d.UpTime.replace("/Date(","").replace(")/",""), 10),"yyyy-MM-dd")}}</div>' }
                            , { field: 'UpUser', title: '更新人', sort: true }
                            , { fixed: 'right', title: '操作', toolbar: '#course-bar', width: 120 }
                        ]]
                        , page: true
                    });

                    //头工具栏事件
                    table.on('toolbar(course-list)', function (obj) {
                        layer.open({
                            type: 2,
                            offset: 't',
                            title:'课程新增',
                            area: ['800px', '630px'],
                            content: ['/admin/courseadd'],//这里content是一个普通的String
                            cancel: function (index1, layero) {
                                layer.confirm('确认关闭吗?', { icon: 3, title: '提示' }, function (index) {
                                    layer.close(index);
                                    layer.close(index1);
                                });
                                return false;
                            }
                        });
                    });

                    //监听行工具事件
                    table.on('tool(course-list)', function (obj) {
                        var data = obj.data;
                        //console.log(obj)
                        if (obj.event === 'del') {
                            layer.confirm('真的删除行么', function (index) {
                                obj.del();
                                layer.close(index);
                            });
                        } else if (obj.event === 'edit') {
                            layer.prompt({
                                formType: 2
                                , value: data.email
                            }, function (value, index) {
                                obj.update({
                                    email: value
                                });
                                layer.close(index);
                            });
                        }
                    });
                });

            </script>
        </div>
    </div>
</body>
</html>
